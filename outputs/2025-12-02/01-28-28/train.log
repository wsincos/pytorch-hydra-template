[__main__][INFO] - ====== Configuration ======
[__main__][INFO] - 
train:
  seed: 42
  device: cuda
  epochs: 3
checkpoint:
  enabled: true
  save_dir: checkpoints
model:
  name: seq2seq_transformer
  wrapper:
    name: Seq2SeqWrapper
  shared:
    src_vocab_size: 21128
    tgt_vocab_size: 21128
    d_model: 512
    pe_cfg:
      name: SinusoidalPE
      d_model: 512
      dropout: 0.1
      max_len: 5000
  arch:
    encoder:
      name: TransformerEncoder
      input_dim: 21128
      d_model: 512
      nhead: 8
      num_layers: 6
      pe_cfg:
        name: SinusoidalPE
        d_model: 512
        dropout: 0.1
        max_len: 5000
    decoder:
      name: TransformerDecoder
      output_dim: 21128
      d_model: 512
      nhead: 8
      num_layers: 6
      pe_cfg:
        name: SinusoidalPE
        d_model: 512
        dropout: 0.1
        max_len: 5000
dataset:
  name: Opus100Dataset
  train_path: ./data/datasets/opus-100/train/train-00000-of-00001.parquet
  test_path: ./data/datasets/opus-100/test/test-00000-of-00001.parquet
  source_lang: en
  target_lang: zh
  tokenizer_path: ./data/pretrained_models/bert-base-multilingual-cased
  max_samples: 500
  seq_len: 128
  batch_size: 32
  num_workers: 8
optimizer:
  name: AdamW
  params:
    lr: 0.0005
    weight_decay: 0.01
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
criterion:
  name: CrossEntropyLoss
  params: {}
logger:
  enable: true
  project: hydra-styple-transformer
  entity: null
  name: test_run_03
  group: null
  tags:
  - opus
  - transformer
  notes: null
  mode: online
callback:
  ckpt:
    name: CheckpointCallback
    params:
      save_every: 1
      keep_last: true
  early_stop:
    name: EarlyStopping
    params:
      patience: 3
      min_delta: 0.001
  training_monitor:
    name: TrainingMonitor
    params:
      log_every_n_steps: 50
  translation_monitor:
    name: TranslationMonitor
    params:
      num_samples: 10
scheduler:
  name: CosineAnnealingLR
  params:
    T_max: 3
    eta_min: 1.0e-06

[__main__][INFO] - ===========================
[__main__][INFO] - Initializing Solver with GPU: 6
[src.solver][INFO] - Building Loader...
[src.data.datasets][INFO] - [Data] Loading local parquet file: ./data/datasets/opus-100/train/train-00000-of-00001.parquet...
[src.data.datasets][INFO] - [Data] Selecting first 500 samples...
[src.data.datasets][INFO] - [Data] Loading Tokenizer from: ./data/pretrained_models/bert-base-multilingual-cased...
[src.data.datasets][INFO] - [Data] Loading local parquet file: ./data/datasets/opus-100/test/test-00000-of-00001.parquet...
[src.solver][INFO] - Auto-setting vocab size from Tokenizer: 119547
[src.solver][INFO] - Building Model: seq2seq_transformer
[src.models.builders][INFO] - [Builder] Instantiating Encoder: TransformerEncoder
[src.models.builders][INFO] - [Builder] Instantiating Decoder: TransformerDecoder
[src.models.builders][INFO] - [Builder] Instantiating Model: Seq2SeqWrapper
[src.solver][INFO] - Building Callback: ckpt (CheckpointCallback)
[src.callbacks.checkpoint][INFO] - [Callback] Checkpoints will be saved to: /data1/jinyu_wang/projects/pytorch-hydra/outputs/2025-12-02/01-28-28/checkpoints
[src.solver][INFO] - Building Callback: early_stop (EarlyStopping)
[src.solver][INFO] - Building Callback: training_monitor (TrainingMonitor)
[src.solver][INFO] - Building Callback: translation_monitor (TranslationMonitor)
[src.solver][INFO] - Start Training... Total Epochs: 3
[src.solver][INFO] - === Epoch 0 Done | Train Loss: 9.3466 ===
[src.callbacks.checkpoint][INFO] - New Best Model! Loss: inf -> 7.5606
[src.callbacks.checkpoint][INFO] - Saved BEST model to /data1/jinyu_wang/projects/pytorch-hydra/outputs/2025-12-02/01-28-28/checkpoints/checkpoint_best.pt
[src.callbacks.generation_monitor][INFO] - --- [Translation Demo] ---
[src.callbacks.generation_monitor][INFO] - Src : C. Draft resolution A / C. 3 / 57 / L. 25 and Rev. 1 and amendment contained in document A / C. 3 / 57 / L. 72
[src.callbacks.generation_monitor][INFO] - Tgt : C.决议草案A/C.3/57/L.25和Rev.1以及文件A/C.3/57/L.72所载修正案
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : ( a ) Complete rotor assemblies :
[src.callbacks.generation_monitor][INFO] - Tgt : 甲替硝基苯胺(MNA;PNMA)
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : 8. 1 The Committee has considered this communication in the light of all the information made available to it by the parties, as required by article 5, paragraph 1, of the Optional Protocol.
[src.callbacks.generation_monitor][INFO] - Tgt : 8.1人权事务委员会根据当事各方依《任择议定书》第五条第1款规定提交的一切现有资料审议了来文。
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : • African Union Commissioner for Peace and Security, Ambassador Said Djinnit, and the Special Representative of the African Union ( AU ) in Burundi, Ambassador Mamadou Bah
[src.callbacks.generation_monitor][INFO] - Tgt : •非洲联盟和平与安全专员SaidDjinnit大使和非洲联盟驻布隆迪特别代表马马杜·巴大使
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Yeah, some of you are like, " He means yogurt. "
[src.callbacks.generation_monitor][INFO] - Tgt : 是的，有些人是喜欢，"他的意思是酸奶。"
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : I have made a great decision. I ' ve decided to get married.
[src.callbacks.generation_monitor][INFO] - Tgt : 我作了伟大的决定，我要结婚了
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Where age structure is concerned, most unemployed persons were found in the 25 - 39 ( 42. 6 % ) and 40 - 54 ( 27. 6 % ) age groups, representing a total of 172, 400 persons, while young people in the 15 - 24 age group accounted for 24. 3 per cent ( 151, 600 ).
[src.callbacks.generation_monitor][INFO] - Tgt : 就年龄结构而言，大多数失业人口在25-39岁年龄组(42.6%)和40-54岁年龄组(27.6%)，总数为172,400人，而在15-24岁年龄组的年轻人占24.3%(151,600人)。
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : The only defence against a nuclear catastrophe is the total elimination of those weapons.
[src.callbacks.generation_monitor][INFO] - Tgt : 防范核灾难的唯一途径就是彻底销毁这些武器。
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Number 24, also from Kaltenbach,
[src.callbacks.generation_monitor][INFO] - Tgt : 同样是来自卡尔特巴赫马场的：
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Part II of the final outcome document containing the review and assessment of the implementation of the Copenhagen Declaration and Programme of Action of the Summit acknowledges that Member States have taken a number of actions to enhance their capacities to achieve goals of the World Summit for Social Development.
[src.callbacks.generation_monitor][INFO] - Tgt : 18．最后结果文件第二部分审查和评估了执行首脑会议《哥本哈根宣言和行动纲领》的情况。该文件确认，会员国已采取各种行动加强实现社会发展问题世界首脑会议目标的能力。
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.solver][INFO] - LR updated to: 0.00037525
[src.solver][INFO] - === Epoch 1 Done | Train Loss: 6.5971 ===
[src.callbacks.checkpoint][INFO] - New Best Model! Loss: 7.5606 -> 7.0707
[src.callbacks.checkpoint][INFO] - Saved BEST model to /data1/jinyu_wang/projects/pytorch-hydra/outputs/2025-12-02/01-28-28/checkpoints/checkpoint_best.pt
[src.callbacks.generation_monitor][INFO] - --- [Translation Demo] ---
[src.callbacks.generation_monitor][INFO] - Src : Add glamour to the foggy night
[src.callbacks.generation_monitor][INFO] - Tgt : 給霧夜添上濃裝
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : The Court did, however, conclude that, as no reasons were given in the letter whereby France informed Djibouti of its refusal to execute the letter rogatory, France had failed to comply with its international obligation under article 17 of the 1986 Convention to provide reasons.
[src.callbacks.generation_monitor][INFO] - Tgt : 不过，法院得出结论认为，因为法国在通知吉布提它将要拒绝执行后者提出的调查委托书的信中没有说明理由，所以法国没有遵守1986年《刑事事项互助公约》第17条为其规定的关于说明理由的国际义务。
[src.callbacks.generation_monitor][INFO] - Pred: 的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Letter dated 5 August 2002 from the Permanent Representative of Oman to the United Nations addressed to the Under - Secretary - General for Economic and Social Affairs
[src.callbacks.generation_monitor][INFO] - Tgt : 2002年8月5日阿曼常驻联合国代表以阿拉伯集团主席的身份给主管经济和社会事务部副秘书长的信
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : In addition to the work of trials, the Tribunal has heard and decided a number of important appeals.
[src.callbacks.generation_monitor][INFO] - Tgt : 除了审判工作外，法庭还听讯了若干重要上诉并对其作出决定。
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : The strategies include capacity - building for human resources in the states and municipalities for implementing the Acute Diarrhoeal Diseases Monitoring Programme ( MDDA ) ; providing direct technical support for states and municipal districts to investigate outbreaks of cholera ; revising the Integrated Cholera Control and Prevention Handbook ( Manual Integrado de Prevenção e Controle da Cólera ) ; reviewing the instruction materials for capacity - building in monitoring acute diarrhoeal diseases ; the transfer of funds under agreements with the State Health Bureaux in north - east Brazil, underwriting the implementation of activities under the Emergency Cholera Control and Prevention Plan
[src.callbacks.generation_monitor][INFO] - Tgt : 战略包括在各州和各市中实施急性腹泻疾病监控方案的人力资源的能力建设；为各州和市辖区提供直接技术支持以调查霍乱发作情况；修订霍乱控制和预防综合手册；审查监控急性腹泻疾病的能力建设的指导说明材料；根据与巴西东北地区的州卫生局订立的协议转移资金，为巴西东北
[src.callbacks.generation_monitor][INFO] - Pred: 的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : So today, I ' m here to actually give you a first glimpse of what the new telescope, Kepler, has been able to tell us in the last few weeks, and, lo and behold, we are back to the harmony and to fulfilling the dreams of Copernicus.
[src.callbacks.generation_monitor][INFO] - Tgt : 所以今天我将会给你展示开普勒望远镜在几周之前所取得的最新成果请看，我们又得到了类似太阳系的平衡这几乎实现了哥白尼的梦想
[src.callbacks.generation_monitor][INFO] - Pred: 的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : I need to finish reading " Don Quixote ".
[src.callbacks.generation_monitor][INFO] - Tgt : 我得读完《堂吉诃德》
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : It ' s none of my business if he ' s gay or not
[src.callbacks.generation_monitor][INFO] - Tgt : ぃgay闽иぐ或摆
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Indeed, there has been a transformation from the extended family to the nuclear family in the wake of the country ' s entry into a phase of rapid urbanization and the spread of education.
[src.callbacks.generation_monitor][INFO] - Tgt : 的确，在国家进入城市化和教育普及的快速发展时代之后，大家庭也在向小家庭转变。
[src.callbacks.generation_monitor][INFO] - Pred: 的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : The present Protocol, of which the Arabic, Chinese, English, French, Russian and Spanish texts are equally authentic, shall be deposited in the archives of the United Nations.
[src.callbacks.generation_monitor][INFO] - Tgt : 1.本议定书的阿拉伯文、中文、英文、法文、俄文和西班牙文文本具有同等效力,应交存联合国档案库。
[src.callbacks.generation_monitor][INFO] - Pred: 的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的
[src.callbacks.generation_monitor][INFO] - --------------------
[src.solver][INFO] - LR updated to: 0.00012575
[src.solver][INFO] - === Epoch 2 Done | Train Loss: 6.2918 ===
[src.callbacks.checkpoint][INFO] - New Best Model! Loss: 7.0707 -> 7.0201
[src.callbacks.checkpoint][INFO] - Saved BEST model to /data1/jinyu_wang/projects/pytorch-hydra/outputs/2025-12-02/01-28-28/checkpoints/checkpoint_best.pt
[src.callbacks.generation_monitor][INFO] - --- [Translation Demo] ---
[src.callbacks.generation_monitor][INFO] - Src : [ Groans ] Hey. Yo!
[src.callbacks.generation_monitor][INFO] - Tgt : ，老兄，感觉咋样？
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Ike Epstein.
[src.callbacks.generation_monitor][INFO] - Tgt : 我是埃克爱普斯登
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Why didn ' t you take that plane?
[src.callbacks.generation_monitor][INFO] - Tgt : 你为什么不乘那班飞机?
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : It is our goal that through a combination of uniform assessments conducted by FA TF, IMF, World Bank, and FA TF - Style Regional Bodies, all countries throughout the world will be assessed against the FATF standards.
[src.callbacks.generation_monitor][INFO] - Tgt : 我们的目标是，通过金融行动工作组、货币基金组织、世界银行和类似于金融行动工作组的区域机构共同进行统一的评估，世界各国都将按照金融行动工作组的标准得到评估。
[src.callbacks.generation_monitor][INFO] - Pred: 的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Hey, sir! Two more please!
[src.callbacks.generation_monitor][INFO] - Tgt : ，服務員，再來兩杯
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Perfect! OK.
[src.callbacks.generation_monitor][INFO] - Tgt : 棒极了!
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : No, but then I wouldn ' t.
[src.callbacks.generation_monitor][INFO] - Tgt : -PaulDelucca?没有.到现在为止应该没有.
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : IDF has announced that it will cease the punitive demolition of houses belonging to persons who have committed acts of violence against Israelis.
[src.callbacks.generation_monitor][INFO] - Tgt : 国防军宣布，将停止惩罚性拆毁对以色列人犯下暴力行为的人的住房。
[src.callbacks.generation_monitor][INFO] - Pred: 的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的的
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : - I ' m keeping this.
[src.callbacks.generation_monitor][INFO] - Tgt : 我会留着它的
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.callbacks.generation_monitor][INFO] - Src : Uh, no, no, no, no, my friend.
[src.callbacks.generation_monitor][INFO] - Tgt : 不不不不我的朋友
[src.callbacks.generation_monitor][INFO] - Pred: [Empty]
[src.callbacks.generation_monitor][INFO] - --------------------
[src.solver][INFO] - LR updated to: 0.00000100
[src.solver][INFO] - Training Finished.
