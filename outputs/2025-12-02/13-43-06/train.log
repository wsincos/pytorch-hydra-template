[__main__] - ====== Configuration ======
[__main__] - 
train:
  seed: 42
  device: cuda
  epochs: 20
checkpoint:
  enabled: true
  save_dir: checkpoints
model:
  name: seq2seq_transformer
  wrapper:
    name: Seq2SeqWrapper
  shared:
    src_vocab_size: 21128
    tgt_vocab_size: 21128
    d_model: 512
    pe_cfg:
      name: SinusoidalPE
      d_model: 512
      dropout: 0.1
      max_len: 5000
  arch:
    encoder:
      name: TransformerEncoder
      input_dim: 21128
      d_model: 512
      nhead: 8
      num_layers: 6
      pe_cfg:
        name: SinusoidalPE
        d_model: 512
        dropout: 0.1
        max_len: 5000
    decoder:
      name: TransformerDecoder
      output_dim: 21128
      d_model: 512
      nhead: 8
      num_layers: 6
      pe_cfg:
        name: SinusoidalPE
        d_model: 512
        dropout: 0.1
        max_len: 5000
dataset:
  name: Opus100Dataset
  train_path: ./data/datasets/opus-100/train/train-00000-of-00001.parquet
  test_path: ./data/datasets/opus-100/test/test-00000-of-00001.parquet
  source_lang: en
  target_lang: zh
  tokenizer_path: ./data/pretrained_models/bert-base-multilingual-cased
  max_samples: -1
  seq_len: 64
  batch_size: 96
  num_workers: 8
optimizer:
  name: AdamW
  params:
    lr: 0.0005
    weight_decay: 0.01
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
criterion:
  name: CrossEntropyLoss
  params: {}
logger:
  enable: false
  project: hydra-style-transformer
  entity: null
  name: test_v1
  group: null
  tags:
  - opus
  - transformer
  notes: null
  mode: online
callback:
  ckpt:
    name: CheckpointCallback
    params:
      save_every: 1
      keep_last: true
  early_stop:
    name: EarlyStopping
    params:
      patience: 3
      min_delta: 0.001
  training_monitor:
    name: TrainingMonitor
    params:
      log_every_n_steps: 10000
  translation_monitor:
    name: TranslationMonitor
    params:
      num_samples: 10
scheduler:
  name: CosineAnnealingLR
  params:
    T_max: 20
    eta_min: 1.0e-06

[__main__] - ===========================
[__main__] - Initializing Solver with GPU: 6
[src.solver] - Building Loader...
[src.data.datasets] - [Data] Loading local parquet file: ./data/datasets/opus-100/train/train-00000-of-00001.parquet...
[src.data.datasets] - [Data] Loading Tokenizer from: ./data/pretrained_models/bert-base-multilingual-cased...
[src.data.datasets] - [Data] Loading local parquet file: ./data/datasets/opus-100/test/test-00000-of-00001.parquet...
[src.solver] - Auto-setting vocab size from Tokenizer: 119547
[src.solver] - Building Model: seq2seq_transformer
[src.models.builders] - [Builder] Instantiating Encoder: TransformerEncoder
[src.models.builders] - [Builder] Instantiating Decoder: TransformerDecoder
[src.models.builders] - [Builder] Instantiating Model: Seq2SeqWrapper
[src.solver] - Building Callback: ckpt (CheckpointCallback)
[src.callbacks.checkpoint] - [Callback] Checkpoints will be saved to: /data1/jinyu_wang/projects/pytorch-hydra/outputs/2025-12-02/13-43-06/checkpoints
[src.solver] - Building Callback: early_stop (EarlyStopping)
[src.solver] - Building Callback: training_monitor (TrainingMonitor)
[src.solver] - Building Callback: translation_monitor (TranslationMonitor)
[src.solver] - Start Training... Total Epochs: 20
[src.solver] - === Epoch 0 Done | Train Loss: 0.0032 ===
[src.callbacks.checkpoint] - New Best Model! Loss: inf -> 10.3943
[src.callbacks.checkpoint] - Saved BEST model to /data1/jinyu_wang/projects/pytorch-hydra/outputs/2025-12-02/13-43-06/checkpoints/checkpoint_best.pt
[src.callbacks.generation_monitor] - --- [Translation Demo] ---
[src.callbacks.generation_monitor] - Src : C. Draft resolution A / C. 3 / 57 / L. 25 and Rev. 1 and amendment contained in document A / C. 3 / 57 / L. 72
[src.callbacks.generation_monitor] - Tgt : C.决议草案A/C.3/57/L.25和Rev.1以及文件A/C.3/57/L.72所载修正案
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.callbacks.generation_monitor] - Src : ( a ) Complete rotor assemblies :
[src.callbacks.generation_monitor] - Tgt : 甲替硝基苯胺(MNA;PNMA)
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.callbacks.generation_monitor] - Src : 8. 1 The Committee has considered this communication in the light of all the information made available to it by the parties, as required by article 5, paragraph 1, of the Optional Protocol.
[src.callbacks.generation_monitor] - Tgt : 8.1人权事务委员会根据当事各方依《任择议定书》第五条第1款规定提交的一切现有资料审议了来文。
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.callbacks.generation_monitor] - Src : • African Union Commissioner for Peace and Security, Ambassador Said Djinnit, and the Special Representative of the African Union ( AU ) in Burundi, Ambassador Mamadou Bah
[src.callbacks.generation_monitor] - Tgt : •非洲联盟和平与安全专员SaidDjinnit大使和非洲联盟驻布隆迪特别代表马马杜·巴大使
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.callbacks.generation_monitor] - Src : Yeah, some of you are like, " He means yogurt. "
[src.callbacks.generation_monitor] - Tgt : 是的，有些人是喜欢，"他的意思是酸奶。"
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.callbacks.generation_monitor] - Src : I have made a great decision. I ' ve decided to get married.
[src.callbacks.generation_monitor] - Tgt : 我作了伟大的决定，我要结婚了
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.callbacks.generation_monitor] - Src : Where age structure is concerned, most unemployed persons were found in the 25 - 39 ( 42. 6 % ) and 40 - 54 ( 27. 6 % ) age groups, representing a total of 172, 400 persons, while young people in the 15 - 24 age group accounted for 24.
[src.callbacks.generation_monitor] - Tgt : 就年龄结构而言，大多数失业人口在25-39岁年龄组(42.6%)和40-54岁年龄组(27.6%)，总数为172,400人，而在15-24岁年龄组的
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.callbacks.generation_monitor] - Src : The only defence against a nuclear catastrophe is the total elimination of those weapons.
[src.callbacks.generation_monitor] - Tgt : 防范核灾难的唯一途径就是彻底销毁这些武器。
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.callbacks.generation_monitor] - Src : Number 24, also from Kaltenbach,
[src.callbacks.generation_monitor] - Tgt : 同样是来自卡尔特巴赫马场的：
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.callbacks.generation_monitor] - Src : Part II of the final outcome document containing the review and assessment of the implementation of the Copenhagen Declaration and Programme of Action of the Summit acknowledges that Member States have taken a number of actions to enhance their capacities to achieve goals of the World Summit for Social Development.
[src.callbacks.generation_monitor] - Tgt : 18．最后结果文件第二部分审查和评估了执行首脑会议《哥本哈根宣言和行动纲领》的情况。该文件确认，会员国已采取各种行动加强实现社
[src.callbacks.generation_monitor] - Pred: [Empty]
[src.callbacks.generation_monitor] - --------------------
[src.solver] - LR updated to: 0.00049693
[src.solver] - === Epoch 1 Done | Train Loss: 0.0029 ===
[src.callbacks.checkpoint] - New Best Model! Loss: 10.3943 -> 9.4111
